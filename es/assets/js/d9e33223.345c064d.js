"use strict";(self.webpackChunkmy_tfg_logbook=self.webpackChunkmy_tfg_logbook||[]).push([[7036],{4225:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>r,default:()=>h,frontMatter:()=>a,metadata:()=>i,toc:()=>l});const i=JSON.parse('{"id":"SkinGPT4/Step_by_Step_Docker_Setup_Guide","title":"Step-by-Step Guide to Setting Up the Docker Container in Docker Desktop","description":"To detect and fix any potential installation issues, it\'s often best to open Docker Desktop, access the terminal, and execute each command step-by-step. This approach allows you to verify that each part of the installation works correctly and identify any errors early on.","source":"@site/docs/4. SkinGPT4/Step_by_Step_Docker_Setup_Guide.md","sourceDirName":"4. SkinGPT4","slug":"/SkinGPT4/Step_by_Step_Docker_Setup_Guide","permalink":"/My-TFG-Logbook/es/docs/SkinGPT4/Step_by_Step_Docker_Setup_Guide","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Formal Installation","permalink":"/My-TFG-Logbook/es/docs/SkinGPT4/Formal Installation"},"next":{"title":"Testing Fine-Tuning Images by RIM-ONE with Llama 3.2 3B","permalink":"/My-TFG-Logbook/es/docs/First Fine Tune Test/fine_tuning_images_by_RIM-ONE_with_llama_3.2_3B"}}');var s=t(4848),o=t(8453);const a={},r="Step-by-Step Guide to Setting Up the Docker Container in Docker Desktop",c={},l=[{value:"Step-by-Step Guide to Running the Dockerfile Commands in Docker Desktop",id:"step-by-step-guide-to-running-the-dockerfile-commands-in-docker-desktop",level:2}];function d(e){const n={code:"code",h1:"h1",h2:"h2",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",...(0,o.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"step-by-step-guide-to-setting-up-the-docker-container-in-docker-desktop",children:"Step-by-Step Guide to Setting Up the Docker Container in Docker Desktop"})}),"\n",(0,s.jsx)(n.p,{children:"To detect and fix any potential installation issues, it's often best to open Docker Desktop, access the terminal, and execute each command step-by-step. This approach allows you to verify that each part of the installation works correctly and identify any errors early on."}),"\n",(0,s.jsx)(n.h2,{id:"step-by-step-guide-to-running-the-dockerfile-commands-in-docker-desktop",children:"Step-by-Step Guide to Running the Dockerfile Commands in Docker Desktop"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Start an Interactive Container"}),":\nBegin by creating a container interactively from the base image. This allows you to run each command and troubleshoot as needed:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"docker run --gpus all -it nvidia/cuda:11.8.0-cudnn8-runtime-ubuntu20.04 /bin/bash\n"})}),"\n",(0,s.jsx)(n.p,{children:"Once inside the container, you can proceed with each command from the Dockerfile."}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Set Environment Variables"}),":\nConfigure necessary environment variables for non-interactive installs and the Conda path:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'export DEBIAN_FRONTEND=noninteractive\nexport PATH="/opt/conda/bin:$PATH"\n'})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Install System Dependencies"}),":\nInstall essential system packages required for the project:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"apt-get update && \\\napt-get install -y wget git libgl1-mesa-glx libglib2.0-0 && \\\nrm -rf /var/lib/apt/lists/*\n"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Install Miniconda"}),":\nDownload and install Miniconda, which you will use to create the Conda environment:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"wget https://repo.anaconda.com/miniconda/Miniconda3-latest-Linux-x86_64.sh -O miniconda.sh\nbash miniconda.sh -b -p /opt/conda\nrm miniconda.sh\n/opt/conda/bin/conda init\n"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Create the Conda Environment"}),":\nEnsure you have your ",(0,s.jsx)(n.code,{children:"environment.yml"})," file in a shared directory accessible from Docker Desktop, or copy its contents here directly. Then, create the environment as specified:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"conda env create -f /path/to/environment.yml\nconda clean -a -y\n"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Install Additional Dependencies with Mamba and Pip"}),":\nOnce the Conda environment is created, install the additional dependencies using ",(0,s.jsx)(n.code,{children:"mamba"})," and ",(0,s.jsx)(n.code,{children:"pip"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"conda install -c conda-forge mamba=1.4.7 && \\\nconda install -y pytorch==2.0.0 torchvision==0.15.0 torchaudio==2.0.0 pytorch-cuda=11.8 -c pytorch -c nvidia && \\\npip install git+https://github.com/lm-sys/FastChat.git@v0.1.10 && \\\npip install transformers==4.28.0\n"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Clone Necessary Git Repositories"}),":\nClone the required repositories to set up model weights and configurations:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"git clone https://huggingface.co/meta-llama/Llama-2-13b-chat-hf\ngit lfs install\ngit clone https://huggingface.co/lmsys/vicuna-13b-delta-v0\ngit clone https://huggingface.co/huggyllama/llama-13b\n"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Apply Delta Weights to the Vicuna Model"}),":\nApply the delta weights to create the final Vicuna model. This requires running a Python script from the FastChat library:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"python -m fastchat.model.apply_delta --base ./llama-13b --target ./vicuna --delta ./vicuna-13b-delta-v0\n"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Copy Project Files"}),":\nUse Docker Desktop\u2019s file-sharing feature or the ",(0,s.jsx)(n.code,{children:"docker cp"})," command to copy the project files from your local machine into the container. You should copy the following structure:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"\u251c\u2500\u2500 Dockerfile             # Placed at the project root\n\u251c\u2500\u2500 environment.yml        # Conda environment file\n\u251c\u2500\u2500 demo.py                # Main demo script\n\u251c\u2500\u2500 eval_configs/          # Configuration files for evaluation\n\u251c\u2500\u2500 skingpt4/              # Main code directory with subfolders\n\u251c\u2500\u2500 weights/               # Folder for model weights (trained .pth files)\n\u2514\u2500\u2500 additional files       # Other files, such as README.md, images, and prompts\n"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Test the Setup"}),":\nOnce everything is installed, run the demo script manually to ensure everything is set up correctly:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"python demo.py --cfg-path eval_configs/skingpt4_eval_llama2_13bchat.yaml --gpu-id 0\n"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Save the Container as an Image"}),":\nIf all steps work without issues, you can save this container as a Docker image. In a separate terminal, run:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"docker commit <container_id> skingpt4_image\n"})}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"By following this interactive approach in Docker Desktop, you can ensure that each installation step completes successfully and identify any issues immediately. Once you\u2019ve confirmed everything works, you can proceed to build the Dockerfile directly, which should now work smoothly based on your manual verification."})]})}function h(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>a,x:()=>r});var i=t(6540);const s={},o=i.createContext(s);function a(e){const n=i.useContext(o);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:a(e.components),i.createElement(o.Provider,{value:n},e.children)}}}]);